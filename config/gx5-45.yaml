# Standalone example params file for GX3, GX4, GX/CX5, RQ1 and GQ7 series devices
# Note: Feature support is device-dependent and some of the following settings may have no affect on your device.
# Please consult your device's documentation for supported features

# Self-note: Removed all things related to other sensors, like GQ7

# ****************************************************************** 
# NOTE: This file is formatted to work with ROS and will not work if specified as the params_file argument in ROS2.
#       If you want to override parameters for ROS2, start with https://github.com/LORD-MicroStrain/microstrain_inertial/blob/ros2/microstrain_inertial_driver/config/empty.yml
# ****************************************************************** 

# ******************************************************************
# General Settings
# ******************************************************************

# port is the main port that the device will communicate over. For all devices except the GQ7, this is the only available port.
# aux_port is only available for the GQ7 and is only needed when streaming RTCM corrections to the device from ROS, or if you want to publish NMEA sentences from this node
port         : "/dev/ttyACM0"
baudrate     : 115200
debug        : False

# If set to true, this will configure the requested baudrate on the device for the main port.
# Note that this will be set on both USB and serial, but will only actually affect the baudrate of a serial connection.
set_baud : False

# Waits for a configurable amount of time until the device exists
# If poll_max_tries is set to -1 we will poll forever until the device exists
poll_port      : False
poll_rate_hz   : 1.0
poll_max_tries : 60

# Number of times to attempt to reconnect to the device if it disconnects while running
# If configure_after_reconnect is true, we will also reconfigure the device after we reconnect
#
# Note: It is strongly recommended to configure after reconnect unless device_setup is set to false
#       as the device will likely initialize in a different state otherwise
reconnect_attempts : 3
configure_after_reconnect : True

# Controls if the driver-defined setup is sent to the device
#     false - The driver will ignore the settings below and use the device's current settings
#     true  - Overwrite the current device settings with those listed below
device_setup : True

# Controls if the driver-defined settings are saved
#     false - Do not save the settings
#     true  - Save the settings in the device's non-volatile memory
save_settings : False

# Controls if the driver creates a raw binary file
#     false - Do not create the file
#     true  - Create the file
#
# Note: The filename will have the following format -
#       model_number "_" serial_number "_" datetime (year_month_day_hour_minute_sec) ".bin"
#           example: "3DM-GX5-45_6251.00001_20_12_01_01_01_01.bin"
# Note: This file is useful for getting support from the manufacturer
raw_file_enable : False

# ****************************************************************** 
# Frame ID Settings 
# ****************************************************************** 

# The mode in which we will publish transforms to the below frame IDs
#     0 - No transforms will be published between any of the non static frame ids. (if publish_mount_to_frame_id_transform is true, it will still be published, and so will the antenna and odometer transforms)
#     1 - Global mode:
#             Transform will be published from earth_frame_id to target_frame_id containing global position
#     2 - Relative mode:
#             Note: In order to use relative mode, you must configure filter_relative_position
#             Transform will be published from earth_frame_id to map_frame_id using relative position configuration
#             Transform between map_frame_id and target_frame_id will be published using position information reported by the device
# for more information, see: https://wiki.ros.org/microstrain_inertial_driver/transforms
tf_mode : 1

# Frame ID that most header.frame_id fields will be populated with.
frame_id: "gx5_45_link"

# Frame IDs determining the transforms published by this node to aid in navigation. See https://www.ros.org/reps/rep-0105.html
# Note: If use_enu_frame is false, these frames (with the exception of earth_frame_id) will automatically have "_ned" appended to them.
map_frame_id       : "map"
earth_frame_id     : "earth"
gnss1_frame_id     : "gx5_45_gnss_1_antenna_link"

# Target frame ID to publish transform to. Note that there needs to be some path of transforms between this and frame_id
#     If tf_mode is set to 1, a transform between earth_frame_id and target_frame_id will be published
#     If tf_mode is set to 2, a transform between map_frame_id and target_frame_id will be published
target_frame_id : "base_link"

# Static transform between mount_frame_id and frame_id.
# Note: It is recommended to define this in a urdf file if you are building a robot, or are able to modify the robot's description.
publish_mount_to_frame_id_transform  : False
mount_to_frame_id_transform          : [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0] # [ x, y, z, qi, qj, qk, qw ]

# Controls if the driver outputs data with-respect-to ENU frame
#     false - position, velocity, and orientation are WRT the NED frame (native device frame)
#     true  - position, velocity, and orientation are WRT the ENU frame
#
# Note: It is strongly recommended to leave this as True if you plan to integrate with other ROS tools
# Note: If this is set to false, all "*_frame_id" variables will have "_ned" appended to them by the driver.
# For more information, see: https://wiki.ros.org/microstrain_inertial_driver/use_enu_frame
use_enu_frame : True


# ****************************************************************** 
# GNSS Settings (only applicable for devices with GNSS) 
# ****************************************************************** 

# Antenna #1 lever arm offset source
#     0 - Disabled:  We will not configure the antenna offset, or publish it as a transform
#     1 - Manual:    We will use the provided vector to configure the device, and publish it as the transform between frame_id and gnss1_frame_id
#     2 - Transform: We will lookup the transform between frame_id and gnss1_frame_id and use it to configure the device. We will ignore gns1_antenna_offset
# Antenna #1 lever arm offset vector
#     For GQ7 - in the vehicle frame wrt IMU origin (meters)
#     For all other models - in the IMU frame wrt IMU origin (meters)
# Note: Make this as accurate as possible for good performance
gnss1_antenna_offset_source : 0
gnss1_antenna_offset        : [0.0, -0.7, -1.0]

# GNSS signal configuration
gnss_glonass_enable : False
gnss_galileo_enable : True
gnss_beidou_enable  : False

# ****************************************************************** 
# Kalman Filter Settings (only applicable for devices with a Kalman Filter) 
# ****************************************************************** 

# Sensor2vehicle frame transformation selector
#     0 = None
#     1 = Euler Angles
#     2 = matrix
#     3 = quaternion
# Note: These are different ways of setting the same parameter in the device.
#       The different options are provided as a convenience.
#       Support for matrix and quaternion options is firmware version dependent (GQ7 supports Quaternion as of firmware 1.0.07)
#       Quaternion order is [i, j, k, w]
# Note: This can cause strange behavior when also using the ROS transform tree.
#       It is recommended to not use this if you want to use the ROS transform tree unless you really know what you are doing
filter_sensor2vehicle_frame_selector : 0
filter_sensor2vehicle_frame_transformation_euler      : [0.0, 0.0, 0.0]
filter_sensor2vehicle_frame_transformation_matrix     : [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]
filter_sensor2vehicle_frame_transformation_quaternion : [0.0, 0.0, 0.0, 1.0]

# Controls if the Kalman filter will auto-init or requires manual initialization
filter_auto_init : False

# Controls if the Kalman filter is reset after the settings are configured
filter_reset_after_config : True

# (All, except -10, and -15 products) Declination Source 1 = None, 2 = magnetic model, 3 = manual 
# Note: When using a CV7, this MUST be changed to either 1, or 3 or the node will not start
filter_declination_source : 1
filter_declination        : 0.23  # This probably doesn't do anything with filter_declination_source set to 1 or 2

# Controls what kind of linear acceleration data is used in the Filter IMU message.
#     If this is set to true, the acceleration will not factor out gravity, if set to false gravity will be filtered out of the linear acceleration.
#     Self-note: The above message makes no sense??? Shouldn't it be the other way?
filter_use_compensated_accel : True

# (GQ7/CV7 full support, GX5-45 limited support) Adaptive filter settings
#     Adaptive level: 0 - off, 1 - Conservative, 2 = Moderate (default), 3 = agressive
#     Time limit: Max duration of measurement rejection prior to recovery, in milliseconds - default = 15000 
#     Self-note: This may or may not be a relavant setting (GX5 vs CX5?)
filter_adaptive_level         : 2
filter_adaptive_time_limit_ms : 15000

# External GPS Time Update Control
# Note: filter_external_gps_time_topic should publish at no more than 1 Hz.
# Note: gps_leap_seconds should be updated to reflect the current number of leap seconds.
# Self-note: Probably not needed right now
filter_enable_external_gps_time_update : False
filter_external_gps_time_topic         : "/external_gps_time"
gps_leap_seconds                       : 18.0

# (All, except GQ7, CV7, -10, and -15 products) Heading Source 0 = None, 1 = magnetic, 2 = GNSS velocity (note: see manual for limitations)  
# Note: For the GQ7, this setting has no effect. See filter_auto_heading_alignment_selector
# Note: When using a -10/-AR product. This MUST be set to 0 or the node will not start
# Self-note: Set to 0 for testing inside
filter_heading_source : 1

# (GX5 and previous,-45 models only) Dynamics Mode 1 = Portable (default), 2 = Automotive, 3 = Airborne (<2Gs), 4 = Airborne High G (<4Gs)
# Self-note: Set to automotive
filter_dynamics_mode : 2

# ****************************************************************** 
# IMU Settings 
# ****************************************************************** 

# Static IMU message covariance values (the device does not generate these) 
imu_orientation_cov   : [0.01, 0, 0, 0, 0.01, 0, 0, 0, 0.01]
imu_linear_cov        : [0.01, 0, 0, 0, 0.01, 0, 0, 0, 0.01]
imu_angular_cov       : [0.01, 0, 0, 0, 0.01, 0, 0, 0, 0.01]
imu_mag_cov           : [0.01, 0, 0, 0, 0.01, 0, 0, 0, 0.01]
imu_pressure_variance : 0.01

# ****************************************************************** 
# Publisher Settings
# ****************************************************************** 
#
#  Note: If set to 0, the data will not be stremaed from the device, and the publisher will not be created

# The speed at which the individual IMU publishers will publish at.
imu_data_rate             : 100  # Rate of imu/data topic
imu_mag_data_rate         : 0    # Rate of imu/mag topic. Self-note: Off inside for now
imu_pressure_data_rate    : 0    # Rate of imu/pressure topic. Self-note: Off inside for now
imu_wheel_speed_data_rate : 0    # Rate of imu/wheel_Speed topic. Self-note: SHOULD be irrelavant

# The speed at which the individual GNSS1 publishers will publish at.
gnss1_llh_position_data_rate   : 2  # Rate of gnss_1/llh_position topic
gnss1_velocity_data_rate       : 2  # Rate of gnss_1/velocity topic
gnss1_velocity_ecef_data_rate  : 0  # Rate of gnss_1/velocity_ecef topic
                                    # Note: gnss1_odometry_earth_data_rate depends on the contents of this message.
                                    #       If it is set to a higher value, this message will be published at that rate.
gnss1_odometry_earth_data_rate : 0  # Rate of gnss_1/odometry_earth topic
gnss1_time_data_rate           : 0  # Rate of gnss_1/time topic

# Self-note: Only one gnss sensor so I removed the second one 

# The speed at which the individual Filter publishers will publish at.
filter_human_readable_status_data_rate : 1  # Rate of ekf/status
filter_imu_data_rate                   : 100  # Rate of ekf/imu/data topic
                                            # Note: Both filter_odometry_earth_data_rate and filter_odometry_map_data_rate depend on the contents of this message.
                                            #       If either are set to a higher value, this message will be published at that rate.
filter_llh_position_data_rate          : 0  # Rate of ekf/llh_position topic
filter_velocity_data_rate              : 0  # Rate of ekf/velocity topic
                                            # Note: filter_odometry_map_data_rate depends on the contents of this message.
                                            #       If either are set to a higher value, this message will be published at that rate.
filter_velocity_ecef_data_rate         : 0  # Rate of ekf/velocity_ecef topic
                                            # Note: filter_odometry_earth_data_rate depends on the contents of this message.
                                            #       If either are set to a higher value, this message will be published at that rate.
filter_odometry_earth_data_rate        : 0 # Rate of ekf/odometry_earth topic
filter_odometry_map_data_rate          : 0 # Rate of ekf/odometry_map topic
filter_dual_antenna_heading_data_rate  : 0  # Rate of ekf/dual_antenna_heading topic
                                            # Note: mip_filter_gnss_position_aiding_status_data_rate depends on the contents of this message.
                                            #       If either are set to a higher value, this message will be published at that rate.

# The speed at which the individual MIP publishers will publish at.
mip_sensor_overrange_status_data_rate : 0  # Rate of mip/sensor/overrange_status topic

mip_gnss1_fix_info_data_rate           : 0  # Rate of mip/gnss_1/fix_info topic
mip_gnss1_sbas_info_data_rate          : 0  # Rate of mip/gnss_1/sbas_info topic
mip_gnss1_rf_error_detection_data_rate : 0  # Rate of mip/gnss_1/rf_error_detection

# Self-note: removed gnss2 here as well

mip_filter_status_data_rate                          : 0  # Rate of mip/filter/status topic
mip_filter_gnss_position_aiding_status_data_rate     : 0  # Rate of mip/filter/gnss_aiding_status
                                                          # Note: filter_llh_position_data_rate depends on the contents of this message.
                                                          #       If it is set to a higher value, this message will be published at that rate.
mip_filter_multi_antenna_offset_correction_data_rate : 0  # Rate of mip/filter/multi_antenna_offset_correction
                                                          # Note: This message will also affect the frequency that the transform between frame_id and gnss_1/2_frame_id are published
mip_filter_gnss_dual_antenna_status_data_rate        : 0  # Rate of mip/filter/gnss_dual_antenna_status
                                                          # Note: filter_dual_antenna_heading_data_rate depends on the contents of this message.
                                                          #       If either are set to a higher value, this message will be published at that rate.
mip_filter_aiding_measurement_summary_data_rate      : 0  # Rate of mip/filter/aiding_measurement_summary topic


# ****************************************************************** 
# NMEA streaming settings
# ****************************************************************** 
# Self-note: don't think we have NMEA so I removed all of this (this should be for RTK stuff)

# External aiding measurement configuration
subscribe_ext_time        : False
subscribe_ext_fix         : False
subscribe_ext_vel_ned     : False
subscribe_ext_vel_enu     : False
subscribe_ext_vel_ecef    : False
subscribe_ext_vel_body    : False
subscribe_ext_heading_ned : False
subscribe_ext_heading_enu : False